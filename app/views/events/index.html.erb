<body>
  <div class="upcoming-events-lokal">
      <div class="banner-upcoming">
          <h1>Upcoming Music Festivals</h1>
      </div>

      <div class="ei-container">
            <h4><% if params[:tag].present? %>
              <% count = @events.count %>
              <% festival_plural = count > 1 ? "events" : "event" %>
              We found <%= count %> <%= params[:tag] %> <%= festival_plural %>
            <% else %>
              <% count = @events.count %>
              <% festival_plural = count > 1 ? "festivals" : "festival" %>
              We found <%= count %> music <%= festival_plural %>
            <% end %>
          </h4>
        </div>

        <div class="gender-events">
        <% @events.each do |event| %>
           <div class="ei-tags">

            <% event.tags.each do |tag| %>
              <!-- <span class="<%= tag_class(tag) %>"><%= tag.name %></span> -->
               <span><%= link_to(tag.name, events_path(tag: tag.name), class: tag_class(tag)) %></span>
              <% end %>
            </div>
           <% end %>
        </div>


        <div class="events-slide">
          <div class="row">
            <swiper-container>
              <% @events.each do |event| %>
                <swiper-slide>
                  <div class="ei-card">
                    <div class="ei-poster">
                      <img src= <%= event.image_url%> alt="">
                            <div class="ei-like">
                             <% if user_signed_in? %>
                              <% if current_user.likes?(event) %>
                                <%= button_to event_like_path(event, current_user.likes.find_by(event: event)), method: :delete, class: "like-button liked" do %>
                              <i class="fa-regular fa-heart"></i>
                              <% end %>
                              <% else %>
                              <%= button_to event_likes_path(event), method: :post, class: "like-button" do %>
                              <i class="fa-regular fa-heart"></i>
                            <% end %>
                          <% end %>
                        <% end %>
                      </div>
                    </div>

                    <div class="ei-details">
                      <h2> <%= event.name %> </h3>

                      <div class="row ei-location-date">
                        <div class="col">
                          <div class="ei-location">
                            <h4><ion-icon name="location-outline"></ion-icon> <span><%= event.venue %></span></h4>
                          </div>
                        </div>
                        <div class="col">
                          <div class="ei-date">
                            <% formatted_date = (event.date).strftime("%b %e") %>
                            <% formatted_start_time = (event.start_time.present? ? event.start_time.strftime("%H:%M") : '') %>
                            <% formatted_end_time = (event.end_time.present? ? event.end_time.strftime("%H:%M") : '') %>
                            <h4><ion-icon name="today-outline"></ion-icon> <span><%= formatted_date %></span></h4>
                            <h4><ion-icon name="time-outline"></ion-icon><span><%= formatted_start_time %> - <%= formatted_end_time %></span></h4>
                          </div>
                        </div>
                      </div>
                      <%= link_to "More", event_path(event), class: "button-event" %>
                    </div>
                  </div>
                </swiper-slide>
              <% end %>
            </swiper-container>
        </div>
            <% if params[:tag].present? %>
            <%= button_to "Remove filter", events_path, method: :get, params: { tag: nil }, class: "btn btn-danger" %>
          <% end %>
      </div>
  </div>
</body>
